# Description: Thumbnail generator based on FFMPEG
# URL:         https://github.com/dirkvdb/ffmpegthumbnailer
# Depends on:  ffmpeg libjpeg-turbo

name=ffmpegthumbnailer
version=2.2.3
release=1
source=$name-$version.tar.gz::https://github.com/dirkvdb/$name/archive/refs/tags/$version.tar.gz

build() {
	cmake -S $name-$version -B build -G Ninja     \
		-D CMAKE_INSTALL_PREFIX=/usr          \
		-D CMAKE_INSTALL_LIBDIR=lib           \
		-D BUILD_SHARED_LIBS=True             \
		-D CMAKE_BUILD_TYPE=RelWithDebugInfo  \
		-D CMAKE_CXX_FLAGS="$CXXFLAGS"        \
		-D CMAKE_C_FLAGS="$CFLAGS"            \
		-D ENABLE_GIO=ON                      \
		-D ENABLE_THUMBNAILER=ON              \
		-D ENABLE_TESTS=OFF                   \
		-Wno-dev

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install
}
