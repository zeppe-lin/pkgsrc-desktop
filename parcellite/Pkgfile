# Description: Lightweight GTK+ clipboard manager
# URL:         https://github.com/ZaWertun/parcellite
# Depends on:  gtk xorg-libsm

name=parcellite
version=1.2.6-0f43353
release=3
source="https://github.com/ZaWertun/$name/archive/${version#*-}/$name-$version.tar.gz
	fix-aboutdlg-link.patch
	parcellite-startup.desktop"

build() {
	patch -d $name-${version#*-}* -Np1 -i $SRC/fix-aboutdlg-link.patch

	cmake -S $name-${version#*-}* -B build -G Ninja          \
		-D CMAKE_INSTALL_PREFIX=/usr                     \
		-D CMAKE_BUILD_TYPE=Release                      \
		-D CMAKE_C_FLAGS_RELEASE="$CFLAGS -DNDEBUG"      \
		-D CMAKE_CXX_FLAGS_RELEASE="$CXXFLAGS -DNDEBUG"  \
		-Wno-dev

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install

	install -m 0644 -Dt $PKG/etc/xdg/autostart $SRC/$name-startup.desktop

	# remove junk
	rm -r $PKG/usr/share/locale
}
