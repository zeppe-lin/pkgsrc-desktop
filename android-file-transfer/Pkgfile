# Description: Android MTP client
# URL:         https://whoozle.github.io/android-file-transfer-linux
# Depends on:  fuse2 qt5 taglib xorg-libxkbfile

name=android-file-transfer
version=4.4-b8ab1ec
release=1
source="https://github.com/whoozle/$name-linux/archive/${version#*-}/$name-$version.tar.gz
	use_system_icons.patch
	aft-mtp-cli.1.pod
	aft-mtp-mount.1.pod
	android-file-transfer.1.pod
	pod2man.Makefile"

build() {
	patch -d $name-linux-* -Np1 -i $SRC/use_system_icons.patch

	export CXXFLAGS="$CXXFLAGS -ffat-lto-objects"

	cmake -S $name-linux-* -B build -G Ninja  \
		-D CMAKE_INSTALL_PREFIX=/usr      \
		-D CMAKE_BUILD_TYPE=None          \

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install

	# build and install man pages
	make -C $SRC -f pod2man.Makefile  \
		VERSION=$version MANPREFIX=/usr/share/man DESTDIR=$PKG install
}
