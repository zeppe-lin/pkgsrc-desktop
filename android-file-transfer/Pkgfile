# Description: Android MTP client
# URL:         https://whoozle.github.io/android-file-transfer-linux
# Depends on:  fuse2 qt5 taglib xorg-libxkbfile

name=android-file-transfer
version=4.4-2a48d30
release=1
source="https://github.com/whoozle/$name-linux/archive/${version#*-}/$name-$version.tar.gz
	aft-mtp-cli.1.pod
	aft-mtp-mount.1.pod
	android-file-transfer.1.pod
	use_system_icons.patch"

build() {
	patch -d $name-linux-* -p1 -i $SRC/use_system_icons.patch

	export CXXFLAGS="$CXXFLAGS -ffat-lto-objects"

	cmake -S $name-linux-* -B build -G Ninja  \
		-D CMAKE_INSTALL_PREFIX=/usr      \
		-D CMAKE_BUILD_TYPE=None          \

	ninja -C build -j ${JOBS:-1} -v
	DESTDIR=$PKG ninja -C build install

	# install man pages
	mkdir -p $PKG/usr/share/man/man1
	for f in $SRC/*.1.pod; do
		pod2man -c ' ' -n $(basename ${f%%.*}) -r $version -s 1 \
			"$f" > $PKG/usr/share/man/man1/$(basename ${f%.*})
	done
}
